<!DOCTYPE html>
<html>
  <head>
    <title>Karaoke Finder</title>
  </head>
  <body>
    <h1>ðŸŽ¤ Karaoke Finder</h1>
    <input id="title" placeholder="Song title" />
    <input id="artist" placeholder="Artist" />
    <button onclick="getKaraoke()">Get Karaoke</button>
    <br /><br />
    <audio id="player" controls></audio>
    <p>ðŸŽµ Lyrics:</p>
    <pre id="lyrics"></pre>

    <script>
      async function getKaraoke() {
        const title = document.getElementById("title").value.trim();
        const artist = document.getElementById("artist").value.trim();
        const player = document.getElementById("player");
        const lyricsBox = document.getElementById("lyrics");

        if (!title || !artist) {
          lyricsBox.textContent = "Please enter both title and artist.";
          return;
        }

        // ðŸŽµ Play Karaoke
        player.src = `netlify/functions/karaoke?title=${encodeURIComponent(
          title
        )}&artist=${encodeURIComponent(artist)}`;
        player.play();

        // ðŸ“œ Fetch Lyrics
        try {
          const res = await fetch(
            `netlify/functions/lyrics?title=${encodeURIComponent(
              title
            )}&artist=${encodeURIComponent(artist)}`
          );

          if (res.ok) {
            const data = await res.json();
            lyricsBox.textContent = data.lyrics || "Lyrics not found.";
          } else {
            lyricsBox.textContent = "Lyrics not found.";
          }
        } catch (e) {
          lyricsBox.textContent = "Error fetching lyrics.";
        }
      }
    </script>
  </body>
</html>
